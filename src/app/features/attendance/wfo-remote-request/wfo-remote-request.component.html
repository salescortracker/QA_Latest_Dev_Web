<app-header></app-header>
<app-sidebar></app-sidebar>

<!-- PAGE HEADER -->
<div class="dashboard-header">
  <h2 class="dashboard-title">WFH / Remote Request</h2>
  <nav class="breadcrumb">
    <a href="#">Home</a> &gt;
    <a href="#">Attendance</a> &gt;
    <span>WFH / Remote Request</span>
  </nav>
</div>

<div class="tab-container mt-4">

  <!-- TAB RADIO BUTTONS -->
  <input type="radio" id="tab1" name="tab" checked>
  <input type="radio" id="tab2" name="tab">

  <!-- TAB HEADERS -->
  <div class="tab-header">
    <label class="tab-label" for="tab1">My Requests</label>
    <label class="tab-label" for="tab2">Manager Approval</label>
  </div>

  <!-- ================= TAB 1 : MY REQUESTS ================= -->
  <div id="content1" class="tab-content">

    <!-- SUBMIT FORM -->
    <div class="card p-4 shadow-sm mb-4">
      <h5>Submit WFH / Remote Request</h5>

      <form (ngSubmit)="submitWfhRequest()">

        <div class="row mb-3">
          <div class="col-md-6">
            <label>From Date</label>
            <input type="date"
                   class="form-control"
                   [(ngModel)]="wfhForm.fromDate"
                   name="fromDate"
                   required>
          </div>

          <div class="col-md-6">
            <label>To Date</label>
            <input type="date"
                   class="form-control"
                   [(ngModel)]="wfhForm.toDate"
                   name="toDate"
                   required>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-md-6">
            <label>Request Type</label>
            <select class="form-select"
                    [(ngModel)]="wfhForm.requestType"
                    name="requestType"
                    required>
              <option value="">Select</option>
              <option>Work from Home</option>
              <option>Remote Work</option>
            </select>
          </div>

          <div class="col-md-6">
            <label>Upload Document</label>
            <input type="file"
                   class="form-control"
                   accept=".pdf,.jpg,.png,.docx">
          </div>
        </div>

        <div class="mb-3">
          <label>Reason / Remarks</label>
          <textarea class="form-control"
                    rows="3"
                    [(ngModel)]="wfhForm.reason"
                    name="reason"
                    required></textarea>
        </div>

        <button type="submit" class="btn btn-primary">
          Submit Request
        </button>
      </form>
    </div>

    <!-- MY REQUESTS LIST -->
    <div class="card p-4 shadow-sm">
      <h5>My Requests</h5>

      <table class="table table-bordered table-hover mt-3">
        <thead>
          <tr>
            <th>From</th>
            <th>To</th>
            <th>Type</th>
            <th>Reason</th>
            <th>Status</th>
            <th>Action</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let req of myRequests">
            <td>{{ req.fromDate | date }}</td>
            <td>{{ req.toDate | date }}</td>
            <td>{{ req.requestType }}</td>
            <td>{{ req.reason }}</td>
            <td>
              <span class="badge"
                [ngClass]="{
                  'bg-warning text-dark': req.status === 'Pending',
                  'bg-success': req.status === 'Approved',
                  'bg-danger': req.status === 'Rejected'
                }">
                {{ req.status }}
              </span>
            </td>
            <td>
              <i class="fa-solid fa-eye text-primary"></i>
            </td>
          </tr>

          <tr *ngIf="myRequests.length === 0">
            <td colspan="6" class="text-center text-muted">
              No requests found
            </td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>

  <!-- ================= TAB 2 : MANAGER APPROVAL ================= -->
  <div id="content2" class="tab-content">

    <div class="card p-4 shadow-sm">
      <h5>Pending WFH / Remote Requests</h5>

      <table class="table table-bordered table-hover mt-3">
        <thead>
          <tr>
            <th>
              <input type="checkbox"
                     [(ngModel)]="selectAll"
                     (change)="toggleSelectAll()">
            </th>
            <th>Employee</th>
            <th>From</th>
            <th>To</th>
            <th>Type</th>
            <th>Reason</th>
            <th>Status</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let req of approvalRequests">
            <td>
              <input type="checkbox"
                     [(ngModel)]="req.selected"
                     (change)="updateSelectAll()">
            </td>
            <td>{{ req.employeeName }}</td>
            <td>{{ req.fromDate | date }}</td>
            <td>{{ req.toDate | date }}</td>
            <td>{{ req.requestType }}</td>
            <td>{{ req.reason }}</td>
            <td>
              <span class="badge bg-warning text-dark">
                {{ req.status }}
              </span>
            </td>
          </tr>

          <tr *ngIf="approvalRequests.length === 0">
            <td colspan="7" class="text-center text-muted">
              No pending approvals
            </td>
          </tr>
        </tbody>
      </table>

      <!-- MANAGER REMARKS -->
      <div class="mt-3">
        <label>Manager Remarks</label>
        <textarea class="form-control"
                  rows="2"
                  [(ngModel)]="managerRemarks"></textarea>
      </div>

      <!-- BULK ACTION BUTTONS -->
      <div class="mt-3">
        <button class="btn btn-success me-2"
                (click)="bulkAction('Approved')">
          Approve Selected
        </button>

        <button class="btn btn-danger"
                (click)="bulkAction('Rejected')">
          Reject Selected
        </button>
      </div>

    </div>

  </div>

</div>

<app-footer></app-footer>
